<!DOCTYPE html>
<html lang="ru" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <!-- Roboto Flex - –æ—Å–Ω–æ–≤–Ω–æ–π —à—Ä–∏—Ñ—Ç -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Flex:opsz,wght@8..144,100;8..144,200;8..144,300;8..144,400;8..144,500;8..144,600;8..144,700;8..144,800;8..144,900&display=swap" rel="stylesheet">
  <!-- Inter - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —à—Ä–∏—Ñ—Ç –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <!-- JetBrains Mono - –º–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω—ã–π —à—Ä–∏—Ñ—Ç –¥–ª—è —á–∏—Å–µ–ª –∏ –∫–æ–¥–∞ -->
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@100;200;300;400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- UI libs (CDN) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  
  <!-- Lucide Icons - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ SVG –∏–∫–æ–Ω–∫–∏ -->
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

  <!-- App styles (–º–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –ø–æ—Ä—è–¥–æ–∫ –∫—Ä–∏—Ç–∏—á–µ–Ω) -->
  <link rel="stylesheet" href="styles_variables.css">
  <link rel="stylesheet" href="styles_typography.css">
  <link rel="stylesheet" href="styles_layout.css">
  <link rel="stylesheet" href="styles_forms.css">
  <link rel="stylesheet" href="styles_components.css">
  <link rel="stylesheet" href="styles_kpi.css">
  <link rel="stylesheet" href="styles_plot.css">
  <link rel="stylesheet" href="styles_states.css">
  <link rel="stylesheet" href="styles_icons.css">
  <link rel="stylesheet" href="styles_fonts.css">
  <link rel="stylesheet" href="styles_theme_animation.css">

  <!-- Charts + libs -->
  <script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <!-- App scripts (—É–ª—É—á—à–µ–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏) -->
  <!-- 1. Core - –æ—Å–Ω–æ–≤–∞ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π -->
  <script defer src="app_core.js"></script>
  
  <!-- 2. Module Loader - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–æ–π –º–æ–¥—É–ª–µ–π -->
  <script defer src="app_module_loader.js"></script>
  
  <!-- 3. –ë–∞–∑–æ–≤—ã–µ –º–æ–¥—É–ª–∏ -->
  <script defer src="app_theme.js"></script>
  <script defer src="app_ui.js"></script>
  
  <!-- 4. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ -->
  <script defer src="app_state.js"></script>
  <script defer src="app_api_info.js"></script>
  <script defer src="app_chart.js"></script>
  <script defer src="app_logs.js"></script>
  <script defer src="app_csv.js"></script>
  <script defer src="app_kpi.js"></script>
  <script defer src="app_strategy_voting.js"></script>
  
  <!-- 5. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è - –ø–æ—Å–ª–µ–¥–Ω–∏–π -->
  <script defer src="app_init.js"></script>

  <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
  <style>
    .loading-indicator {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity 0.8s ease;
      overflow: hidden;
    }
    
    .loading-indicator.hidden {
      opacity: 0;
      pointer-events: none;
    }
    
    /* –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω —Å —Ç–æ—Ä–≥–æ–≤—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ */
    .trading-background {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0.1;
      z-index: 1;
    }
    
    .trading-grid {
      position: absolute;
      width: 100%;
      height: 100%;
      background-image: 
        linear-gradient(rgba(110, 70, 255, 0.1) 1px, transparent 1px),
        linear-gradient(90deg, rgba(110, 70, 255, 0.1) 1px, transparent 1px);
      background-size: 50px 50px;
      animation: gridMove 20s linear infinite;
    }
    
    @keyframes gridMove {
      0% { transform: translate(0, 0); }
      100% { transform: translate(50px, 50px); }
    }
    
    /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–æ–Ω–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã */
    .trading-background::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at 20% 80%, rgba(110, 70, 255, 0.05) 0%, transparent 50%),
                  radial-gradient(circle at 80% 20%, rgba(32, 201, 195, 0.05) 0%, transparent 50%);
      animation: backgroundPulse 8s ease-in-out infinite;
    }
    
    @keyframes backgroundPulse {
      0%, 100% { opacity: 0.5; }
      50% { opacity: 1; }
    }
    
    /* –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
    .loading-center {
      position: relative;
      z-index: 10;
      text-align: center;
      animation: centerFloat 6s ease-in-out infinite;
    }
    
    @keyframes centerFloat {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }
    
    /* –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏–Ω–Ω–µ—Ä –≤ –≤–∏–¥–µ –≥—Ä–∞—Ñ–∏–∫–∞ */
    .chart-spinner {
      width: 120px;
      height: 120px;
      margin: 0 auto 30px;
      position: relative;
      filter: drop-shadow(0 0 40px rgba(110, 70, 255, 0.4));
    }
    
    .chart-circle {
      width: 100%;
      height: 100%;
      border: 3px solid transparent;
      border-top: 3px solid #6E46FF;
      border-right: 3px solid #20C9C3;
      border-radius: 50%;
      animation: chartRotate 2s linear infinite;
      position: relative;
      filter: drop-shadow(0 0 20px rgba(110, 70, 255, 0.3));
    }
    
    .chart-circle::before {
      content: '';
      position: absolute;
      top: -3px;
      left: -3px;
      right: -3px;
      bottom: -3px;
      border: 2px solid transparent;
      border-top: 2px solid rgba(110, 70, 255, 0.3);
      border-radius: 50%;
      animation: chartRotate 1.5s linear infinite reverse;
      filter: drop-shadow(0 0 15px rgba(110, 70, 255, 0.2));
    }
    
    .chart-circle::after {
      content: '';
      position: absolute;
      top: -6px;
      left: -6px;
      right: -6px;
      bottom: -6px;
      border: 1px solid transparent;
      border-top: 1px solid rgba(32, 201, 195, 0.2);
      border-radius: 50%;
      animation: chartRotate 3s linear infinite;
      filter: drop-shadow(0 0 10px rgba(32, 201, 195, 0.1));
    }
    
    @keyframes chartRotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –∏–∫–æ–Ω–∫–∞ –±–æ—Ç–∞ */
    .bot-icon {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 40px;
      height: 40px;
      background: linear-gradient(45deg, #6E46FF, #20C9C3);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      animation: botPulse 2s ease-in-out infinite;
      box-shadow: 0 0 30px rgba(110, 70, 255, 0.5);
    }
    
    .bot-icon::before {
      content: 'ü§ñ';
      font-size: 20px;
      animation: botWiggle 1s ease-in-out infinite;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
    }
    
    @keyframes botPulse {
      0%, 100% { transform: translate(-50%, -50%) scale(1); }
      50% { transform: translate(-50%, -50%) scale(1.1); }
    }
    
    @keyframes botWiggle {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(-5deg); }
      75% { transform: rotate(5deg); }
    }
    
    /* –¢–µ–∫—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ */
    .loading-text {
      color: #ffffff;
      font-size: 24px;
      font-family: 'Inter', sans-serif;
      font-weight: 600;
      margin-bottom: 20px;
      text-shadow: 0 0 20px rgba(110, 70, 255, 0.5);
      animation: textGlow 2s ease-in-out infinite;
      position: relative;
    }
    
    .loading-text::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 2px;
      background: linear-gradient(90deg, #6E46FF, #20C9C3);
      animation: textUnderline 2s ease-in-out infinite;
    }
    
    @keyframes textGlow {
      0%, 100% { text-shadow: 0 0 20px rgba(110, 70, 255, 0.5); }
      50% { text-shadow: 0 0 30px rgba(110, 70, 255, 0.8), 0 0 40px rgba(32, 201, 195, 0.6); }
    }
    
    @keyframes textUnderline {
      0%, 100% { width: 0; }
      50% { width: 100%; }
    }
    
    /* –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –∫–∞–∫ —Ä–∞—Å—Ç—É—â–∏–π –≥—Ä–∞—Ñ–∏–∫ */
    .progress-container {
      width: 400px;
      height: 8px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      overflow: hidden;
      position: relative;
      margin: 20px 0;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
    }
    
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #6E46FF, #20C9C3, #6E46FF);
      background-size: 200% 100%;
      border-radius: 4px;
      width: 0%;
      transition: width 0.5s ease;
      position: relative;
      animation: progressShine 2s linear infinite;
      box-shadow: 0 0 20px rgba(110, 70, 255, 0.4);
    }
    
    @keyframes progressShine {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }
    
    /* –°–≤–µ—á–∏ –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ */
    .progress-candles {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }
    
    .candle {
      position: absolute;
      width: 2px;
      height: 12px;
      background: #20C9C3;
      border-radius: 1px;
      animation: candleGrow 0.5s ease-out;
    }
    
    .candle::before {
      content: '';
      position: absolute;
      top: -2px;
      left: 50%;
      transform: translateX(-50%);
      width: 4px;
      height: 2px;
      background: #6E46FF;
      border-radius: 1px;
    }
    
    @keyframes candleGrow {
      0% { height: 0; opacity: 0; }
      100% { height: 12px; opacity: 1; }
    }
    
    /* –°—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏ */
    .loading-status {
      color: rgba(255, 255, 255, 0.7);
      font-size: 14px;
      font-family: 'JetBrains Mono', monospace;
      margin-top: 15px;
      opacity: 0;
      animation: statusFadeIn 0.5s ease 0.5s forwards;
      transition: all 0.3s ease;
      padding: 8px 16px;
      background: rgba(110, 70, 255, 0.1);
      border-radius: 20px;
      border: 1px solid rgba(110, 70, 255, 0.2);
      backdrop-filter: blur(10px);
    }
    
    @keyframes statusFadeIn {
      to { opacity: 1; }
    }
    
    /* –õ–µ—Ç–∞—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–∞—à–±–æ—Ä–¥–∞ */
    .flying-elements {
      position: absolute;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 5;
    }
    
    .element {
      position: absolute;
      opacity: 0;
      animation: elementFly 3s ease-in-out infinite;
    }
    
    .element.chart { animation-delay: 0s; }
    .element.kpi { animation-delay: 0.5s; }
    .element.logs { animation-delay: 1s; }
    .element.csv { animation-delay: 1.5s; }
    
    @keyframes elementFly {
      0% {
        opacity: 0;
        transform: translateY(100px) scale(0.5) rotate(-180deg);
      }
      20% {
        opacity: 1;
        transform: translateY(0) scale(1) rotate(0deg);
      }
      80% {
        opacity: 1;
        transform: translateY(0) scale(1) rotate(0deg);
      }
      100% {
        opacity: 0;
        transform: translateY(-100px) scale(0.5) rotate(180deg);
      }
    }
    
    /* –ò–∫–æ–Ω–∫–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
    .element-icon {
      width: 30px;
      height: 30px;
      background: linear-gradient(45deg, #6E46FF, #20C9C3);
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 16px;
      box-shadow: 0 4px 15px rgba(110, 70, 255, 0.3);
      animation: elementPulse 2s ease-in-out infinite;
      position: relative;
      overflow: hidden;
    }
    
    .element-icon::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(45deg);
      animation: elementShine 3s linear infinite;
    }
    
    @keyframes elementPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    
    @keyframes elementShine {
      0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
      100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
    }
    
    /* –ß–∞—Å—Ç–∏—Ü—ã */
    .particles {
      position: absolute;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 2;
    }
    
    .particle {
      position: absolute;
      width: 2px;
      height: 2px;
      background: #6E46FF;
      border-radius: 50%;
      animation: particleFloat 4s linear infinite;
      box-shadow: 0 0 6px currentColor;
    }
    
    @keyframes particleFloat {
      0% {
        opacity: 0;
        transform: translateY(100vh) scale(0) rotate(0deg);
      }
      10% {
        opacity: 1;
        transform: translateY(90vh) scale(1) rotate(180deg);
      }
      90% {
        opacity: 1;
        transform: translateY(10vh) scale(1) rotate(360deg);
      }
      100% {
        opacity: 0;
        transform: translateY(0) scale(0) rotate(720deg);
      }
    }
    
    /* –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Å–≤–µ—á–∏ */
    .candle {
      position: absolute;
      width: 2px;
      height: 12px;
      background: #20C9C3;
      border-radius: 1px;
      animation: candleGrow 0.5s ease-out;
      box-shadow: 0 0 8px rgba(32, 201, 195, 0.6);
    }
    
    .candle::before {
      content: '';
      position: absolute;
      top: -2px;
      left: 50%;
      transform: translateX(-50%);
      width: 4px;
      height: 2px;
      background: #6E46FF;
      border-radius: 1px;
      box-shadow: 0 0 6px rgba(110, 70, 255, 0.8);
    }
    
    .candle::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 50%;
      transform: translateX(-50%);
      width: 6px;
      height: 1px;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 0.5px;
    }
    
    @keyframes candleGrow {
      0% { 
        height: 0; 
        opacity: 0; 
        transform: scaleY(0);
      }
      50% {
        transform: scaleY(1.2);
      }
      100% { 
        height: 12px; 
        opacity: 1; 
        transform: scaleY(1);
      }
    }
    
    /* –£–ª—É—á—à–µ–Ω–Ω—ã–π —Å–ø–∏–Ω–Ω–µ—Ä */
    .chart-circle {
      width: 100%;
      height: 100%;
      border: 3px solid transparent;
      border-top: 3px solid #6E46FF;
      border-right: 3px solid #20C9C3;
      border-radius: 50%;
      animation: chartRotate 2s linear infinite;
      position: relative;
      filter: drop-shadow(0 0 20px rgba(110, 70, 255, 0.3));
    }
    
    .chart-circle::before {
      content: '';
      position: absolute;
      top: -3px;
      left: -3px;
      right: -3px;
      bottom: -3px;
      border: 2px solid transparent;
      border-top: 2px solid rgba(110, 70, 255, 0.3);
      border-radius: 50%;
      animation: chartRotate 1.5s linear infinite reverse;
      filter: drop-shadow(0 0 15px rgba(110, 70, 255, 0.2));
    }
    
    .chart-circle::after {
      content: '';
      position: absolute;
      top: -6px;
      left: -6px;
      right: -6px;
      bottom: -6px;
      border: 1px solid transparent;
      border-top: 1px solid rgba(32, 201, 195, 0.2);
      border-radius: 50%;
      animation: chartRotate 3s linear infinite;
      filter: drop-shadow(0 0 10px rgba(32, 201, 195, 0.1));
    }
    
    /* –£–ª—É—á—à–µ–Ω–Ω–∞—è –∏–∫–æ–Ω–∫–∞ –±–æ—Ç–∞ */
    .bot-icon {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 40px;
      height: 40px;
      background: linear-gradient(45deg, #6E46FF, #20C9C3);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      animation: botPulse 2s ease-in-out infinite;
      box-shadow: 0 0 30px rgba(110, 70, 255, 0.5);
    }
    
    .bot-icon::before {
      content: 'ü§ñ';
      font-size: 20px;
      animation: botWiggle 1s ease-in-out infinite;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
    }
    
    /* –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä */
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #6E46FF, #20C9C3, #6E46FF);
      background-size: 200% 100%;
      border-radius: 4px;
      width: 0%;
      transition: width 0.5s ease;
      position: relative;
      animation: progressShine 2s linear infinite;
      box-shadow: 0 0 20px rgba(110, 70, 255, 0.4);
    }
    
    /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è */
    .loading-indicator.animate-in {
      animation: loadingAppear 1s ease-out;
    }
    
    @keyframes loadingAppear {
      0% {
        opacity: 0;
        transform: scale(0.9) rotate(-2deg);
      }
      50% {
        transform: scale(1.02) rotate(1deg);
      }
      100% {
        opacity: 1;
        transform: scale(1) rotate(0deg);
      }
    }
    
    /* –ê–Ω–∏–º–∞—Ü–∏—è –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è */
    .loading-indicator.animate-out {
      animation: loadingDisappear 0.8s ease-in forwards;
    }
    
    @keyframes loadingDisappear {
      0% {
        opacity: 1;
        transform: scale(1) rotate(0deg);
      }
      100% {
        opacity: 0;
        transform: scale(1.1) rotate(5deg);
      }
    }
    
    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
    @media (max-width: 768px) {
      .progress-container {
        width: 300px;
      }
      
      .loading-text {
        font-size: 20px;
      }
      
      .chart-spinner {
        width: 100px;
        height: 100px;
      }
      
      .bot-icon {
        width: 35px;
        height: 35px;
      }
      
      .bot-icon::before {
        font-size: 18px;
      }
    }
  </style>
</head>
<body class="cyrillic-text">
  <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
  <div id="loadingIndicator" class="loading-indicator animate-in">
    <!-- –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω -->
    <div class="trading-background">
      <div class="trading-grid"></div>
    </div>
    
    <!-- –ß–∞—Å—Ç–∏—Ü—ã -->
    <div class="particles" id="particles"></div>
    
    <!-- –õ–µ—Ç–∞—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–∞—à–±–æ—Ä–¥–∞ -->
    <div class="flying-elements">
      <div class="element chart" style="top: 20%; left: 15%;">
        <div class="element-icon">üìä</div>
      </div>
      <div class="element kpi" style="top: 25%; right: 20%;">
        <div class="element-icon">üìà</div>
      </div>
      <div class="element logs" style="bottom: 30%; left: 10%;">
        <div class="element-icon">üìù</div>
      </div>
      <div class="element csv" style="bottom: 25%; right: 15%;">
        <div class="element-icon">üìã</div>
      </div>
    </div>
    
    <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="loading-center">
      <!-- –°–ø–∏–Ω–Ω–µ—Ä –≤ –≤–∏–¥–µ –≥—Ä–∞—Ñ–∏–∫–∞ -->
      <div class="chart-spinner">
        <div class="chart-circle"></div>
        <div class="bot-icon"></div>
      </div>
      
      <!-- –¢–µ–∫—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ -->
      <div class="loading-text">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞—à–±–æ—Ä–¥–∞</div>
      
      <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –∫–∞–∫ –≥—Ä–∞—Ñ–∏–∫ -->
      <div class="progress-container">
        <div class="progress-bar" id="loadingProgressBar"></div>
        <div class="progress-candles" id="progressCandles"></div>
      </div>
      
      <!-- –°—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏ -->
      <div class="loading-status" id="loadingStatus">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã...</div>
    </div>
  </div>

  <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
  <nav class="navbar navbar-expand-lg navbar-dark px-3">
    <div class="d-flex align-items-center gap-2">
      <a class="navbar-brand d-flex align-items-center" href="#">
        <i data-lucide="bot" class="navbar-brand-icon"></i>
        –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–æ—Ç–∞
      </a>
      <!-- –ü–∏–ª—é–ª—è —Å—Ç–∞—Ç—É—Å–∞ -->
      <div class="status-pill" id="statusPill" title="–°–æ—Å—Ç–æ—è–Ω–∏–µ API" data-bs-toggle="tooltip">
        <span class="status-dot status-warn" id="statusDot"></span>
        <span id="statusText">offline</span>
      </div>
      
      <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ç–µ–∫—É—â–µ–≥–æ API -->
      <div class="api-indicator" id="apiIndicator" title="–¢–µ–∫—É—â–∏–π API" data-bs-toggle="tooltip">
        <i data-lucide="server" class="api-icon" id="apiIcon"></i>
        <span id="apiName">‚Äî</span>
      </div>
    </div>
    <div class="ms-auto d-flex align-items-center gap-2">
      <div class="form-check form-switch text-nowrap" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É" data-bs-toggle="tooltip">
        <input class="form-check-input" type="checkbox" id="themeToggle">
        <label class="form-check-label" for="themeToggle">
          <div class="theme-icon-container">
            <i data-lucide="moon" class="theme-icon theme-icon-moon"></i>
            <i data-lucide="sun" class="theme-icon theme-icon-sun"></i>
          </div>
          –¢–µ–º–∞
        </label>
      </div>
      <button id="refreshAll" class="btn btn-sm btn-outline-light" title="–û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –ø–∞–Ω–µ–ª–∏" data-bs-toggle="tooltip">
        <i data-lucide="refresh-cw" class="btn-icon"></i>
        –û–±–Ω–æ–≤–∏—Ç—å –≤—Å—ë
      </button>
    </div>
  </nav>

  <div id="topProgress"></div>

  <div id="snackbar" style="position:fixed;left:50%;transform:translateX(-50%);bottom:16px;z-index:2000;display:none;max-width:90%;">
    <div class="card p-2" style="background:var(--surface);box-shadow:var(--elev-2);">
      <span id="snackbarMsg"></span>
    </div>
  </div>

  <div class="content container-fluid">
    <!-- KPI -->
    <div class="row g-3 mb-3">
      <div class="col-12 col-sm-6 col-xl-3">
        <div class="card p-3 kpi kpi-balance" data-kpi-type="balance">
          <div class="kpi-header">
            <div class="kpi-icon">
              <i data-lucide="wallet" class="kpi-icon-svg"></i>
            </div>
            <div class="kpi-sub">–ë–∞–ª–∞–Ω—Å</div>
          </div>
          <div class="kpi-value" id="kpi-balance">
            <span class="skeleton lg"></span>
          </div>
          <div class="kpi-footer">
            <span class="text-muted" id="kpi-balance-cur">USDT</span>
            <div class="kpi-trend" id="kpi-balance-trend"></div>
          </div>
        </div>
      </div>
      
      <div class="col-12 col-sm-6 col-xl-3">
        <div class="card p-3 kpi kpi-positions" data-kpi-type="positions">
          <div class="kpi-header">
            <div class="kpi-icon">
              <i data-lucide="trending-up" class="kpi-icon-svg"></i>
            </div>
            <div class="kpi-sub">–ü–æ–∑–∏—Ü–∏–∏</div>
          </div>
          <div class="kpi-content">
            <div class="kpi-left">
              <div class="kpi-value" id="kpi-positions">
                <span class="skeleton lg"></span>
              </div>
              <div class="kpi-footer">
                <span class="text-muted">–û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏</span>
                <div class="kpi-badge" id="kpi-positions-badge"></div>
              </div>
            </div>
            <div class="kpi-right">
              <div class="strategy-voting-animation" id="strategy-voting">
                <!-- –ê–Ω–∏–º–∞—Ü–∏—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ JavaScript -->
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="col-12 col-sm-6 col-xl-3">
        <div class="card p-3 kpi kpi-updated" data-kpi-type="updated">
          <div class="kpi-header">
            <div class="kpi-icon">
              <i data-lucide="clock" class="kpi-icon-svg"></i>
            </div>
            <div class="kpi-sub">–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</div>
          </div>
          <div class="kpi-value" id="kpi-updated">
            <span class="skeleton lg"></span>
          </div>
          <div class="kpi-footer">
            <span class="text-muted">state.json</span>
            <div class="kpi-status" id="kpi-updated-status"></div>
          </div>
        </div>
      </div>
      
      <div class="col-12 col-sm-6 col-xl-3">
        <div class="card p-3 kpi kpi-file" data-kpi-type="file">
          <div class="kpi-header">
            <div class="kpi-icon">
              <i data-lucide="bar-chart-3" class="kpi-icon-svg"></i>
            </div>
            <div class="kpi-sub">–§–∞–π–ª –¥–∞–Ω–Ω—ã—Ö</div>
          </div>
          <div class="kpi-value file-name" id="kpi-file">
            <span class="skeleton lg"></span>
          </div>
          <div class="kpi-footer">
            <span class="text-muted">–∏—Å—Ç–æ—á–Ω–∏–∫ –≥—Ä–∞—Ñ–∏–∫–∞</span>
            <div class="kpi-indicator" id="kpi-file-indicator"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tabs -->
    <ul class="nav nav-tabs" id="viewTabs" role="tablist" style="position:relative;">
      <li class="nav-item"><button class="nav-link active" id="chart-tab" data-bs-toggle="tab" data-bs-target="#chart-pane" type="button"><i data-lucide="line-chart" class="tab-icon"></i> –ì—Ä–∞—Ñ–∏–∫ —Ü–µ–Ω</button></li>
      <li class="nav-item"><button class="nav-link" id="csv-tab" data-bs-toggle="tab" data-bs-target="#csv-pane" type="button"><i data-lucide="table" class="tab-icon"></i> CSV –¥–∞–Ω–Ω—ã–µ</button></li>
      <li class="nav-item"><button class="nav-link" id="logs-tab" data-bs-toggle="tab" data-bs-target="#logs-pane" type="button"><i data-lucide="file-text" class="tab-icon"></i> –õ–æ–≥–∏</button></li>
      <li class="nav-item"><button class="nav-link" id="logs-all-tab" data-bs-toggle="tab" data-bs-target="#logs-all-pane" type="button"><i data-lucide="files" class="tab-icon"></i> –í—Å–µ –ª–æ–≥–∏</button></li>
      <li class="nav-item"><button class="nav-link" id="state-tab" data-bs-toggle="tab" data-bs-target="#state-pane" type="button"><i data-lucide="wallet" class="tab-icon"></i> –ë–∞–ª–∞–Ω—Å –∏ –ø–æ–∑–∏—Ü–∏–∏</button></li>
      <span id="tabsInk" class="tabs-ink"></span>
    </ul>

    <div class="tab-content mt-3">
      <!-- Chart -->
      <div class="tab-pane fade show active" id="chart-pane">
        <div class="card p-3 mb-3">
          <div class="toolbar">
            <div class="group">
              <label class="form-label">CSV‚Äë—Ñ–∞–π–ª</label>
              <select id="csvFile" class="form-select form-select-sm field-outlined" title="–§–∞–π–ª –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞" data-bs-toggle="tooltip"></select>
            </div>
            <div class="group narrow">
              <label class="form-label">–•–≤–æ—Å—Ç (—Å—Ç—Ä–æ–∫)</label>
              <input id="tailRows" type="number" min="50" step="50" value="200" class="form-control form-control-sm field-outlined" title="–°–∫–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å—Ç—Ä–æ–∫ –∑–∞–≥—Ä—É–∑–∏—Ç—å" data-bs-toggle="tooltip"/>
            </div>
            <div class="group">
              <label class="form-label">–ë—ã—Å—Ç—Ä—ã–π —Ö–≤–æ—Å—Ç</label>
              <div id="tailSegments" class="btn-group btn-group-sm" role="group" title="–ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä —Ä–∞–∑–º–µ—Ä–∞ —Ö–≤–æ—Å—Ç–∞" data-bs-toggle="tooltip">
                <button class="btn btn-outline-light active" data-tail="200">200</button>
                <button class="btn btn-outline-light" data-tail="500">500</button>
                <button class="btn btn-outline-light" data-tail="1000">1000</button>
              </div>
            </div>
            <div class="group narrow">
              <label class="form-label">–ü–∞–Ω–µ–ª—å 2</label>
              <select id="lowerPanel" class="form-select form-select-sm field-outlined" title="–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤ –Ω–∏–∂–Ω–µ–π –ø–∞–Ω–µ–ª–∏" data-bs-toggle="tooltip">
                <option value="rsi" selected>RSI</option>
                <option value="volume">–û–±—ä—ë–º</option>
              </select>
            </div>
            <div id="rsiControls" class="group narrow" style="display:none;">
              <label class="form-label">RSI –ø–µ—Ä–∏–æ–¥</label>
              <input id="rsiPeriod" type="number" min="2" step="1" value="14" class="form-control form-control-sm field-outlined" title="–ü–µ—Ä–∏–æ–¥ RSI" data-bs-toggle="tooltip"/>
            </div>
            <div class="group" style="min-width:280px;">
              <label class="form-label">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å</label>
              <div class="chips">
                <div class="chip" id="chipSMA20" data-bind="#sma20" title="–í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å SMA 20" data-bs-toggle="tooltip"><i data-lucide="activity" class="chip-icon"></i> SMA 20</div>
                <div class="chip" id="chipSMA50" data-bind="#sma50" title="–í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å SMA 50" data-bs-toggle="tooltip"><i data-lucide="activity" class="chip-icon"></i> SMA 50</div>
                <div class="chip" id="chipSigRSI" data-bind="#signals_rsi" title="RSI" data-bs-toggle="tooltip"><i data-lucide="zap" class="chip-icon"></i> RSI</div>
                <div class="chip" id="chipSigXGB" data-bind="#signals_xgb" title="XGB" data-bs-toggle="tooltip"><i data-lucide="bot" class="chip-icon"></i> XGB</div>
                <div class="chip" id="chipSigMACD" data-bind="#signals_macd" title="MACD" data-bs-toggle="tooltip"><i data-lucide="trending-up" class="chip-icon"></i> MACD</div>
                <div class="chip" id="chipSigBOLLINGER" data-bind="#signals_bollinger" title="Bollinger" data-bs-toggle="tooltip"><i data-lucide="move" class="chip-icon"></i> Bollinger</div>
                <div class="chip" id="chipSigStochastic" data-bind="#signals_stochastic" title="Stochastic" data-bs-toggle="tooltip"><i data-lucide="activity" class="chip-icon"></i> Stochastic</div>
                <div class="chip" id="chipSigWilliamsR" data-bind="#signals_williams_r" title="Williams %R" data-bs-toggle="tooltip"><i data-lucide="gauge" class="chip-icon"></i> Williams %R</div>
              </div>
            </div>
            <div class="ms-auto">
              <div class="d-flex gap-2">
                <button id="resetZoom" class="btn btn-outline-light btn-sm" title="–°–±—Ä–æ—Å–∏—Ç—å –º–∞—Å—à—Ç–∞–± –≥—Ä–∞—Ñ–∏–∫–∞" data-bs-toggle="tooltip">
                  <i data-lucide="maximize-2" class="btn-icon"></i>
                  –°–±—Ä–æ—Å –º–∞—Å—à—Ç–∞–±–∞
                </button>
                <button class="btn btn-outline-light btn-sm" data-bs-toggle="offcanvas" data-bs-target="#advancedSheet" title="–î–æ–ø. –ø–∞—Ä–∞–º–µ—Ç—Ä—ã" data-bs-toggle2="tooltip">
                  <i data-lucide="sliders" class="btn-icon"></i>
                  –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
                </button>
              </div>
            </div>
          </div>
        </div>

        <div class="card p-2 chart-actions">
          <div id="chart">
            <div id="chartLoader" class="loading-overlay" style="display:none;">
              <div class="spinner-border text-light" role="status"><span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</span></div>
            </div>
          </div>
          <button id="reloadChart" class="fab" title="–ü–µ—Ä–µ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫" data-bs-toggle="tooltip">
            <span class="fab-ico-wrap">
              <span class="fab-ring" aria-hidden="true">
                <svg viewBox="0 0 40 40">
                  <circle class="ring-bg" cx="20" cy="20" r="16"></circle>
                  <circle id="fabRing" class="ring" cx="20" cy="20" r="16" stroke-dasharray="100" stroke-dashoffset="100"></circle>
                </svg>
              </span>
              <i data-lucide="refresh-cw" class="fab-icon"></i>
            </span>
          </button>
        </div>
      </div>

      <!-- CSV preview -->
      <div class="tab-pane fade" id="csv-pane">
        <div class="card p-3 mb-3">
          <div class="toolbar">
            <div class="group narrow">
              <label class="form-label">–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ (—Å—Ç—Ä–æ–∫)</label>
              <input id="csvViewTail" type="number" min="50" step="50" value="300" class="form-control form-control-sm field-outlined"/>
            </div>
            <div class="ms-auto d-flex gap-2">
              <button class="btn btn-outline-light btn-sm" id="csvReload">
                <i data-lucide="refresh-cw" class="btn-icon"></i>
                –û–±–Ω–æ–≤–∏—Ç—å
              </button>
              <button class="btn btn-outline-light btn-sm" id="csvDownload">
                <i data-lucide="download" class="btn-icon"></i>
                –°–∫–∞—á–∞—Ç—å –∫–∞–∫ CSV
              </button>
            </div>
          </div>
        </div>
        <div class="card p-2 position-relative">
          <div id="csvLoader" class="loading-overlay" style="display:none;">
            <div class="spinner-border text-light" role="status"><span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</span></div>
          </div>
          <div style="max-height:520px; overflow:auto;">
            <table class="table-md3" id="csvTable">
              <thead id="csvThead"></thead>
              <tbody id="csvTbody"><tr><td><span class="skeleton" style="height:24px;display:block"></span></td></tr></tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Logs by file -->
      <div class="tab-pane fade" id="logs-pane">
        <div class="card p-3 mb-3">
          <div class="toolbar">
            <div class="group"><label class="form-label">–§–∞–π–ª –ª–æ–≥–æ–≤</label><select id="logFile" class="form-select form-select-sm field-outlined"></select></div>
            <div class="group narrow"><label class="form-label">–•–≤–æ—Å—Ç (—Å—Ç—Ä–æ–∫)</label><input id="logTail" type="number" min="100" step="100" value="500" class="form-control form-control-sm field-outlined"/></div>
            <div class="ms-auto">
              <button class="btn btn-outline-light btn-sm" id="reloadLogs" title="–û–±–Ω–æ–≤–∏—Ç—å –ª–æ–≥" data-bs-toggle="tooltip">
                <i data-lucide="refresh-cw" class="btn-icon"></i>
                –û–±–Ω–æ–≤–∏—Ç—å
              </button>
              <button class="btn btn-outline-light btn-sm" data-bs-toggle="offcanvas" data-bs-target="#logsSheet" title="–î–æ–ø. –ø–∞—Ä–∞–º–µ—Ç—Ä—ã" data-bs-toggle2="tooltip">
                <i data-lucide="sliders" class="btn-icon"></i>
                –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
              </button>
            </div>
          </div>
        </div>
        <div class="card p-2 position-relative">
          <div id="logLoader" class="loading-overlay" style="display:none;">
            <div class="spinner-border text-light" role="status"><span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</span></div>
          </div>
          <div class="log-box" id="logBox"><div class="empty">
            <svg viewBox="0 0 120 120" aria-hidden="true">
              <defs>
                <linearGradient id="g1" x1="0" x2="1" y1="0" y2="1">
                  <stop offset="0%"  stop-color="#6E46FF"/>
                  <stop offset="100%" stop-color="#20C9C3"/>
                </linearGradient>
              </defs>
              <circle cx="60" cy="60" r="46" fill="url(#g1)">
                <animate attributeName="r" values="42;46;42" dur="3s" repeatCount="indefinite"/>
              </circle>
              <circle cx="60" cy="60" r="26" fill="rgba(255,255,255,.18)"/>
            </svg>
            <div class="title">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</div>
            <div class="sub">–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è —Ö–≤–æ—Å—Ç –ª–æ–≥–æ–≤</div>
          </div></div>
        </div>
      </div>

      <!-- Logs all -->
      <div class="tab-pane fade" id="logs-all-pane">
        <div class="card p-3 mb-3">
          <div class="toolbar">
            <div id="logLevelButtons" class="btn-group" role="group" aria-label="levels">
              <button class="btn btn-outline-light btn-sm btn-filter active" data-level="ALL">ALL</button>
              <button class="btn btn-outline-light btn-sm btn-filter" data-level="INFO">INFO</button>
              <button class="btn btn-outline-light btn-sm btn-filter" data-level="WARN">WARN</button>
              <button class="btn btn-outline-light btn-sm btn-filter" data-level="ERROR">ERROR</button>
              <button class="btn btn-outline-light btn-sm btn-filter" data-level="DEBUG">DEBUG</button>
            </div>
            <div class="group"><label class="form-label">–ü–æ–∏—Å–∫</label><input id="logsAllQuery" class="form-control form-control-sm field-outlined" placeholder="—Ç–µ–∫—Å—Ç‚Ä¶"/></div>
            <div class="group narrow"><label class="form-label">–ü–æ—Å–ª–µ–¥–Ω–∏–µ N</label><input id="logsAllN" type="number" min="100" step="100" value="1000" class="form-control form-control-sm field-outlined"/></div>
            <div class="ms-auto">
              <button class="btn btn-outline-light btn-sm" id="reloadLogsAll">
                <i data-lucide="refresh-cw" class="btn-icon"></i>
                –û–±–Ω–æ–≤–∏—Ç—å
              </button>
              <button class="btn btn-outline-light btn-sm" data-bs-toggle="offcanvas" data-bs-target="#logsAllSheet">
                <i data-lucide="sliders" class="btn-icon"></i>
                –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
              </button>
            </div>
          </div>
        </div>
        <div class="card p-2 position-relative">
          <div id="logsAllLoader" class="loading-overlay" style="display:none;">
            <div class="spinner-border text-light" role="status"><span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</span></div>
          </div>
          <div class="log-box" id="logsAllBox"><div class="empty">
            <svg viewBox="0 0 120 120" aria-hidden="true">
              <defs>
                <linearGradient id="g2" x1="0" x2="1" y1="0" y2="1">
                  <stop offset="0%"  stop-color="#6E46FF"/>
                  <stop offset="100%" stop-color="#20C9C3"/>
                </linearGradient>
              </defs>
              <rect x="15" y="20" width="90" height="18" rx="9" fill="url(#g2)">
                <animate attributeName="width" values="70;90;70" dur="2.6s" repeatCount="indefinite"/>
              </rect>
              <rect x="25" y="48" width="70" height="18" rx="9" fill="rgba(255,255,255,.18)"/>
            </svg>
            <div class="title">–õ–æ–≥–∏ –ø—É—Å—Ç—ã</div>
            <div class="sub">–û–∂–∏–¥–∞–µ–º —Å–æ–±—ã—Ç–∏—è‚Ä¶</div>
          </div></div>
        </div>
      </div>

      <!-- State -->
      <div class="tab-pane fade" id="state-pane">
        <div class="row g-3">
          <div class="col-12 col-lg-6">
            <div class="card p-3"><h5 class="mb-3">–ë–∞–ª–∞–Ω—Å</h5><div id="state-balance"><span class="skeleton lg" style="max-width:180px"></span></div></div>
          </div>
          <div class="col-12 col-lg-6">
            <div class="card p-3">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <h5 class="mb-0">–ü–æ–∑–∏—Ü–∏–∏</h5>
                <div class="btn-group btn-group-sm">
                  <button class="btn btn-outline-light" id="posExport">
                    <i data-lucide="download" class="btn-icon"></i>
                    CSV
                  </button>
                  <button class="btn btn-outline-light" id="posRefresh" title="–û–±–Ω–æ–≤–∏—Ç—å">
                    <i data-lucide="refresh-cw" class="btn-icon"></i>
                  </button>
                </div>
              </div>
              <div style="max-height:420px; overflow:auto;">
                <table class="table-md3" id="posTable">
                  <thead><tr>
                    <th>–¢–∏–∫–µ—Ä</th><th class="num">–ö–æ–ª-–≤–æ</th><th class="num">–í—Ö–æ–¥</th><th class="num">–¶–µ–Ω–∞</th><th class="num">PnL</th>
                  </tr></thead>
                  <tbody id="posTbody"><tr><td colspan="5"><span class="skeleton" style="height:24px;display:block"></span></td></tr></tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div><!-- /state -->
    </div>
  </div>

  <!-- Bottom sheets -->
  <div class="offcanvas offcanvas-bottom text-bg-dark" tabindex="-1" id="advancedSheet" style="height:auto;">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title">
        <i data-lucide="sliders" class="offcanvas-icon"></i>
        –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥—Ä–∞—Ñ–∏–∫–∞
      </h5>
      <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body small d-flex flex-wrap gap-3">
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" id="autoRefreshChart" checked>
        <label class="form-check-label" for="autoRefreshChart">–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</label>
      </div>
      <div>
        <label class="form-label">–ò–Ω—Ç–µ—Ä–≤–∞–ª (—Å)</label>
        <input id="chartInterval" type="number" min="5" step="5" value="10" class="form-control form-control-sm field-outlined"/>
      </div>
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" id="logScaleSwitch">
        <label class="form-check-label" for="logScaleSwitch">–õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∏–π –º–∞—Å—à—Ç–∞–± —Ü–µ–Ω—ã</label>
      </div>
    </div>
  </div>

  <div class="offcanvas offcanvas-bottom text-bg-dark" tabindex="-1" id="logsSheet" style="height:auto;">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title">
        <i data-lucide="sliders" class="offcanvas-icon"></i>
        –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ª–æ–≥–æ–≤
      </h5>
      <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body small d-flex flex-wrap gap-3">
      <div class="form-check form-switch"><input class="form-check-input" type="checkbox" id="autoRefreshLogs"><label class="form-check-label" for="autoRefreshLogs">–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</label></div>
      <div><label class="form-label">–ò–Ω—Ç–µ—Ä–≤–∞–ª (—Å)</label><input id="logsInterval" type="number" min="5" step="5" value="15" class="form-control form-control-sm field-outlined"/></div>
    </div>
  </div>

  <div class="offcanvas offcanvas-bottom text-bg-dark" tabindex="-1" id="logsAllSheet" style="height:auto;">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title">
        <i data-lucide="sliders" class="offcanvas-icon"></i>
        –ü–∞—Ä–∞–º–µ—Ç—Ä—ã ¬´–í—Å–µ –ª–æ–≥–∏¬ª
      </h5>
      <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body small d-flex flex-wrap gap-3">
      <div class="form-check form-switch"><input class="form-check-input" type="checkbox" id="autoRefreshLogsAll"><label class="form-check-label" for="autoRefreshLogsAll">–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</label></div>
      <div><label class="form-label">–ò–Ω—Ç–µ—Ä–≤–∞–ª (—Å)</label><input id="logsAllInterval" type="number" min="5" step="5" value="15" class="form-control form-control-sm field-outlined"/></div>
    </div>
  </div>

  <!-- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Lucide –∏–∫–æ–Ω–æ–∫ –∏ —Å–∫—Ä—ã—Ç–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏ -->
  <script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤—Å–µ Lucide –∏–∫–æ–Ω–∫–∏ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    document.addEventListener('DOMContentLoaded', function() {
      lucide.createIcons();
    });

    // –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º –∑–∞–≥—Ä—É–∑–∫–∏
    const LoadingManager = {
      progress: 0,
      maxProgress: 100,
      statusMessages: [
        '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã...',
        '–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...',
        '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π...',
        '–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞...',
        '–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API...',
        '–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...',
        '–§–∏–Ω–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞...',
        '–ì–æ—Ç–æ–≤–æ!'
      ],
      currentStatusIndex: 0,
      particles: [],
      
      init: function() {
        this.createParticles();
        this.animateParticles();
      },
      
      createParticles: function() {
        const particlesContainer = document.getElementById('particles');
        if (!particlesContainer) return;
        
        // –°–æ–∑–¥–∞–µ–º 20 —á–∞—Å—Ç–∏—Ü
        for (let i = 0; i < 20; i++) {
          const particle = document.createElement('div');
          particle.className = 'particle';
          
          // –°–ª—É—á–∞–π–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –∏ –∑–∞–¥–µ—Ä–∂–∫–∞
          particle.style.left = Math.random() * 100 + '%';
          particle.style.animationDelay = Math.random() * 4 + 's';
          particle.style.animationDuration = (Math.random() * 2 + 3) + 's';
          
          // –°–ª—É—á–∞–π–Ω—ã–π —Ä–∞–∑–º–µ—Ä
          const size = Math.random() * 3 + 1;
          particle.style.width = size + 'px';
          particle.style.height = size + 'px';
          
          // –°–ª—É—á–∞–π–Ω—ã–π —Ü–≤–µ—Ç
          const colors = ['#6E46FF', '#20C9C3', '#FF6B6B', '#4ECDC4'];
          particle.style.background = colors[Math.floor(Math.random() * colors.length)];
          
          particlesContainer.appendChild(particle);
          this.particles.push(particle);
        }
      },
      
      animateParticles: function() {
        // –ê–Ω–∏–º–∞—Ü–∏—è —á–∞—Å—Ç–∏—Ü –∫–∞–∂–¥—ã–µ 100–º—Å
        setInterval(() => {
          this.particles.forEach((particle, index) => {
            if (Math.random() > 0.95) {
              // –°–ª—É—á–∞–π–Ω–æ –º–µ–Ω—è–µ–º –ø–æ–∑–∏—Ü–∏—é
              particle.style.left = Math.random() * 100 + '%';
              particle.style.animationDelay = '0s';
              particle.style.animationDuration = (Math.random() * 2 + 3) + 's';
            }
          });
        }, 100);
      },
      
      updateProgress: function(value) {
        this.progress = Math.min(value, this.maxProgress);
        const progressBar = document.getElementById('loadingProgressBar');
        if (progressBar) {
          progressBar.style.width = this.progress + '%';
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
        this.updateStatus();
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Å–≤–µ—á–∏ –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å
        this.addCandles();
        
        // –£—Å–∫–æ—Ä—è–µ–º —á–∞—Å—Ç–∏—Ü—ã –ø—Ä–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ
        this.updateParticleSpeed();
      },
      
      updateStatus: function() {
        const statusElement = document.getElementById('loadingStatus');
        if (!statusElement) return;
        
        // –ü–ª–∞–≤–Ω–æ –º–µ–Ω—è–µ–º —Å—Ç–∞—Ç—É—Å
        statusElement.style.opacity = '0';
        setTimeout(() => {
          const progressPercent = (this.progress / this.maxProgress) * 100;
          const statusIndex = Math.floor((progressPercent / 100) * (this.statusMessages.length - 1));
          
          if (statusIndex !== this.currentStatusIndex && statusIndex < this.statusMessages.length) {
            this.currentStatusIndex = statusIndex;
            statusElement.textContent = this.statusMessages[statusIndex];
            
            // –î–æ–±–∞–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞
            statusElement.style.transform = 'scale(1.1)';
            setTimeout(() => {
              statusElement.style.transform = 'scale(1)';
            }, 200);
          }
          
          statusElement.style.opacity = '1';
        }, 200);
      },
      
      addCandles: function() {
        const candlesContainer = document.getElementById('progressCandles');
        if (!candlesContainer) return;
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Å–≤–µ—á—É –∫–∞–∂–¥—ã–µ 10% –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        if (this.progress % 10 === 0 && this.progress > 0) {
          const candle = document.createElement('div');
          candle.className = 'candle';
          
          // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º —Å–≤–µ—á—É –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–µ
          const position = (this.progress / this.maxProgress) * 100;
          candle.style.left = position + '%';
          
          // –°–ª—É—á–∞–π–Ω–∞—è –≤—ã—Å–æ—Ç–∞ —Å–≤–µ—á–∏ (–∫–∞–∫ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º –≥—Ä–∞—Ñ–∏–∫–µ)
          const height = Math.random() * 8 + 8; // 8-16px
          candle.style.height = height + 'px';
          
          // –°–ª—É—á–∞–π–Ω—ã–π —Ü–≤–µ—Ç (–∑–µ–ª–µ–Ω—ã–π/–∫—Ä–∞—Å–Ω—ã–π –∫–∞–∫ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ)
          const isGreen = Math.random() > 0.5;
          candle.style.background = isGreen ? '#20C9C3' : '#FF6B6B';
          
          // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–Ω—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ü–≤–µ—Ç–∞
          if (isGreen) {
            candle.style.boxShadow = '0 0 8px rgba(32, 201, 195, 0.6)';
          } else {
            candle.style.boxShadow = '0 0 8px rgba(255, 107, 107, 0.6)';
          }
          
          candlesContainer.appendChild(candle);
          
          // –£–¥–∞–ª—è–µ–º —Å–≤–µ—á—É —á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è
          setTimeout(() => {
            if (candle.parentNode) {
              candle.style.opacity = '0';
              candle.style.transform = 'scale(0.5)';
              setTimeout(() => {
                if (candle.parentNode) {
                  candle.parentNode.removeChild(candle);
                }
              }, 300);
            }
          }, 3000);
        }
      },
      
      updateParticleSpeed: function() {
        // –£—Å–∫–æ—Ä—è–µ–º —á–∞—Å—Ç–∏—Ü—ã –ø—Ä–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ
        const speedMultiplier = 1 + (this.progress / 100) * 0.5;
        this.particles.forEach(particle => {
          particle.style.animationDuration = (4 / speedMultiplier) + 's';
        });
      },
      
      hide: function() {
        const indicator = document.getElementById('loadingIndicator');
        if (indicator) {
          indicator.classList.add('animate-out');
          setTimeout(() => {
            indicator.style.display = 'none';
          }, 800);
        }
      },
      
      show: function() {
        const indicator = document.getElementById('loadingIndicator');
        if (indicator) {
          indicator.style.display = 'flex';
          indicator.classList.remove('animate-out');
          indicator.classList.add('animate-in');
        }
      },
      
      // –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
      complete: function() {
        const indicator = document.getElementById('loadingIndicator');
        if (!indicator) return;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å
        const statusElement = document.getElementById('loadingStatus');
        if (statusElement) {
          statusElement.textContent = 'üéâ –î–∞—à–±–æ—Ä–¥ –≥–æ—Ç–æ–≤!';
          statusElement.style.color = '#20C9C3';
          statusElement.style.fontWeight = 'bold';
          statusElement.style.textShadow = '0 0 20px rgba(32, 201, 195, 0.8)';
        }
        
        // –§–∏–Ω–∞–ª—å–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è —á–∞—Å—Ç–∏—Ü
        this.particles.forEach((particle, index) => {
          setTimeout(() => {
            particle.style.animation = 'none';
            particle.style.transform = 'scale(2) rotate(360deg)';
            particle.style.opacity = '0';
            particle.style.transition = 'all 0.5s ease';
          }, index * 50);
        });
        
        // –ê–Ω–∏–º–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
        setTimeout(() => {
          this.hide();
        }, 2000);
      }
    };

    // –°–ª—É—à–∞–µ–º —Å–æ–±—ã—Ç–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –¥–∞—à–±–æ—Ä–¥–∞
    window.addEventListener('dashboardReady', function() {
      console.log('üéâ –î–∞—à–±–æ—Ä–¥ –≥–æ—Ç–æ–≤! –ó–∞–≤–µ—Ä—à–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –∑–∞–≥—Ä—É–∑–∫–∏...');
      LoadingManager.updateProgress(100);
      LoadingManager.complete();
    });

    // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
    if (window.App && window.App.DependencyManager) {
      const checkProgress = () => {
        const status = window.App.DependencyManager.getDependencyStatus();
        const readyCount = Object.values(status).filter(Boolean).length;
        const totalCount = Object.keys(status).length;
        const progress = Math.round((readyCount / totalCount) * 40); // 40% –∑–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
        LoadingManager.updateProgress(progress);
        
        if (readyCount < totalCount) {
          setTimeout(checkProgress, 100);
        }
      };
      checkProgress();
    }

    // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥—É–ª–µ–π
    if (window.App && window.App.ModuleLoader) {
      const checkModuleProgress = () => {
        const status = window.App.ModuleLoader.getLoadStatus();
        if (Object.keys(status).length === 0) {
          setTimeout(checkModuleProgress, 100);
          return;
        }
        
        const loadedCount = Object.values(status).filter(m => m.loaded).length;
        const totalCount = Object.keys(status).length;
        const progress = 40 + Math.round((loadedCount / totalCount) * 40); // 40-80% –∑–∞ –º–æ–¥—É–ª–∏
        LoadingManager.updateProgress(progress);
        
        if (loadedCount < totalCount) {
          setTimeout(checkModuleProgress, 100);
        }
      };
      
      // –ñ–¥–µ–º –ø–æ—è–≤–ª–µ–Ω–∏—è ModuleLoader
      setTimeout(checkModuleProgress, 500);
    }

    // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    document.addEventListener('DOMContentLoaded', function() {
      LoadingManager.show();
      LoadingManager.init(); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —á–∞—Å—Ç–∏—Ü—ã
      LoadingManager.updateProgress(5); // –ù–∞—á–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å
    });
  </script>
</body>
</html>
